import Iter "mo:base/Iter";
import Array "mo:base/Array";
import Text "mo:base/Text";
import Nat32 "mo:base/Nat32";
import Debug "mo:base/Debug";
import PseudoRandom "./PseudoRandom";


module {

public func char(fontIndex:Nat32, c:Nat32) : [Nat32] {

    let s: Nat = Nat32.toNat(fontIndex*charsCount*16 + c*16);

    return Iter.toArray(
        Iter.map(
            Iter.range(0, 15),
             func(x : Nat) : Nat32 { fonts[ s + x ] }
            )
        );

};

public func randCaptcha(entropy: PseudoRandom.PseudoRandom, length:Nat) : (Text,[Nat32]) {
    
    var bitmap:[Nat32] = [];
    var correct:Text = "";
    var x = 0;
    while (x < length) {
        let fontIndex = entropy.get(5) % fontsCount;
        let charIdx = entropy.get(8) % charsCount;
        bitmap := Array.append(bitmap, char(fontIndex, charIdx) );
        correct := correct # chars[ Nat32.toNat(charIdx) ];
        x := x + 1;
    };

    return (correct, bitmap);
};


// Motoko character map
// 59 charaters per font
// Order: qwetyuiopasdfghjkzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM123456789
// 6 fonts
// 16x16 pixels each character

public let chars: [Text] = ["q","w","e","t","y","u","i","o","p","a","s","d","f","g","h","j","k","z","x","c","v","b","n","m","Q","W","E","R","T","Y","U","I","O","P","A","S","D","F","G","H","J","K","L","Z","X","C","V","B","N","M","1","2","3","4","5","6","7","8","9"];
public let charsCount: Nat32 = 59;
public let fontsCount: Nat32 = 6;
public let fonts : [Nat32] = [0,0,0,0,224,240,248,216,108,124,124,108,96,32,48,48,
0,0,0,0,3992,4060,3548,3544,1528,2040,952,472,0,0,0,0,
0,0,0,0,112,120,120,56,12,44,60,28,0,0,0,0,
0,0,96,48,248,248,24,24,24,24,56,56,8,0,0,0,
0,0,0,0,512,792,828,944,432,224,224,96,96,48,56,24,
0,0,0,0,816,952,444,408,472,1016,504,472,72,0,0,0,
48,48,48,0,24,60,24,24,24,120,56,24,0,0,0,0,
0,0,0,0,112,240,216,200,76,108,60,56,0,0,0,0,
0,0,0,48,184,248,252,220,216,104,56,28,12,12,12,12,
0,0,0,0,224,240,216,232,236,508,220,92,64,0,0,0,
0,0,0,0,96,48,24,56,48,48,60,30,0,0,0,0,
896,384,448,192,224,240,216,216,104,508,252,252,64,0,0,0,
224,48,48,48,120,120,16,24,24,24,24,24,24,12,12,15,
0,0,0,0,48,120,120,104,60,60,56,16,16,60,62,51,
240,48,56,24,216,248,248,152,220,204,236,124,32,0,0,0,
96,96,32,0,48,56,48,48,48,24,24,24,24,24,12,15,
112,48,48,16,88,248,248,120,120,1016,476,508,0,0,0,0,
0,0,0,0,112,2040,2012,448,224,120,2044,2016,384,0,0,0,
0,0,0,0,1840,2040,2016,192,192,480,956,924,0,0,0,0,
0,0,0,0,112,120,24,12,12,108,60,28,0,0,0,0,
0,0,0,0,408,476,444,432,240,240,112,48,0,0,0,0,
112,48,56,24,88,120,120,88,104,124,60,56,24,0,0,0,
0,0,0,0,432,504,508,240,216,984,472,216,0,0,0,0,
0,0,0,0,3504,4024,4092,4080,2040,1752,3800,1752,512,0,0,0,
0,0,32,248,476,412,396,396,412,476,248,240,480,896,3840,7680,
0,0,0,57148,50744,53048,28464,28656,32224,14816,14560,14528,4288,0,0,0,
0,0,0,504,432,48,48,496,176,48,496,508,0,0,0,0,
0,0,384,1020,2032,1840,1840,1008,1008,944,1904,3836,2112,0,0,0,
0,0,0,8188,6604,2500,448,448,448,448,992,2032,0,0,0,0,
0,0,0,3964,824,880,480,448,448,448,960,2032,992,0,0,0,
0,0,8,3900,1560,1560,1560,1560,1560,1816,824,1008,224,0,0,0,
0,0,0,124,24,56,24,56,56,56,56,124,0,0,0,0,
0,0,0,1008,1944,1820,3596,1548,1564,1564,1016,496,0,0,0,0,
0,0,0,508,496,816,944,496,176,48,60,124,0,0,0,0,
0,0,128,448,448,448,992,992,992,816,1848,4028,0,0,0,0,
0,0,224,240,56,120,496,960,896,908,924,508,248,0,0,0,
0,0,0,2040,4088,7264,7264,7264,7264,3168,4088,2044,0,0,0,0,
0,0,0,2032,1272,204,1998,1990,1734,192,192,1008,0,0,0,0,
0,0,0,1008,1848,1564,28,924,924,284,504,496,0,0,0,0,
0,0,0,7804,3608,1592,1656,2040,1592,1560,1592,3900,0,0,0,0,
0,0,0,124,48,48,48,48,48,48,48,48,48,27,31,7,
0,0,0,3964,432,240,240,496,432,944,3960,7932,0,0,0,0,
0,0,0,248,56,56,56,56,56,568,1016,508,0,0,0,0,
0,32,4592,16376,3852,900,448,112,56,124,224,448,896,1792,1792,15872,
0,0,1536,8188,1648,992,448,448,960,864,1840,7996,7680,0,0,0,
0,0,0,240,248,28,12,12,12,156,252,120,48,0,0,0,
0,0,0,7996,1592,1848,880,1008,480,480,192,192,128,0,0,0,
0,0,0,252,504,432,432,496,432,952,504,508,0,0,0,0,
0,0,0,32316,7288,6384,6640,7088,7984,7728,7728,7420,6144,0,0,0,
0,0,12384,30960,7392,7392,7392,8160,7072,7072,14768,32124,32,0,0,0,
0,0,0,120,120,96,96,96,96,96,112,248,0,0,0,0,
0,0,112,248,236,192,224,96,48,304,508,508,128,0,0,0,
0,0,0,248,456,448,240,240,448,384,460,252,32,0,0,0,
0,0,128,192,224,240,216,1020,1020,192,192,480,0,0,0,0,
0,0,256,504,504,24,248,504,384,384,460,252,32,0,0,0,
0,0,128,224,48,24,248,508,924,412,412,504,0,0,0,0,
0,0,0,508,252,196,96,96,48,48,56,56,16,0,0,0,
0,0,0,240,472,472,248,248,476,396,412,252,48,0,0,0,
0,0,0,504,476,396,476,508,464,192,96,56,24,0,0,0,
0,0,0,0,384,992,1656,1560,1800,1816,2040,2032,1536,1536,1536,1536,
0,0,0,0,1024,3072,7240,14540,12780,16380,8188,2616,0,0,0,0,
0,0,0,0,480,1016,924,1020,252,124,1528,2032,1984,0,0,0,
56,56,24,24,56,248,248,24,28,28,56,248,64,0,0,0,
0,0,0,0,0,540,1564,1820,1948,2040,1760,1536,1536,1536,768,896,
0,0,0,0,8,1848,1820,1852,1820,1948,8184,4080,1536,0,0,0,
0,56,56,24,0,24,24,24,28,152,248,248,32,0,0,0,
0,0,0,0,224,2040,3896,7196,3100,3612,2044,2032,0,0,0,0,
0,0,0,0,792,2040,2040,1912,1848,952,504,248,120,24,24,24,
0,0,0,0,240,496,440,412,924,972,2040,3832,0,0,0,0,
0,0,0,0,240,496,280,120,496,384,504,248,56,0,0,0,
1536,1536,1792,1792,1920,4080,4088,3596,3596,8092,14840,12408,0,0,0,0,
48,48,48,48,48,496,1016,252,124,112,96,112,112,112,112,16,
0,0,0,0,112,1008,2040,1564,1564,3832,3824,3584,3584,3584,1536,2040,
28,28,12,28,28,476,476,1020,1020,956,1820,1564,0,0,0,0,
224,0,192,224,224,224,192,192,192,192,192,192,192,193,97,103,
0,24,24,56,14392,15416,7992,1848,2040,1016,8120,7216,0,0,0,0,
0,0,0,0,0,496,496,448,224,48,2044,4092,0,0,0,0,
0,0,0,0,12,956,504,240,496,1008,1936,1816,1032,0,0,0,
0,0,0,0,992,2032,56,60,28,28,2040,1008,0,0,0,0,
0,0,0,0,1024,1548,1564,792,952,496,480,224,0,0,0,0,
24,28,28,504,1016,792,792,792,920,472,248,120,56,0,0,0,
0,0,0,12,268,908,2012,2044,1916,1596,3644,7192,0,0,0,0,
0,0,0,0,16832,62456,64504,65400,57144,53048,50744,34328,0,0,0,0,
192,1008,1968,3864,3608,3080,7404,7644,7132,8088,3960,4080,8128,6144,0,0,
28688,28696,28696,24984,25496,25496,29656,29692,30716,13944,15480,7224,48,0,0,0,
2048,8176,4088,120,24,24,504,252,56,4120,8184,4088,1536,0,0,0,
448,2032,4088,3128,3096,1560,984,504,504,984,3992,16152,7176,6144,0,0,
7936,8188,8188,508,448,384,448,448,448,448,192,192,128,0,0,0,
28672,14364,7228,7416,8160,3968,3584,1792,896,896,384,192,96,0,0,0,
1536,1560,3608,3608,3096,3096,3096,3096,3096,3128,1592,2032,992,0,0,0,
0,1008,1016,192,192,192,192,192,192,192,2040,1020,8,0,0,0,
384,992,1904,3696,3640,3640,3128,3128,3128,3640,3704,2032,992,0,0,0,
4064,4088,7196,3196,3708,2016,496,240,48,112,96,112,96,0,0,0,
0,384,448,960,992,992,1648,2032,4088,3096,3100,6156,2048,0,0,0,
240,504,504,28,28,120,248,224,384,384,496,240,112,0,0,0,
0,508,1020,2040,1888,3680,3184,3184,3168,1632,992,496,32,0,0,0,
1024,4080,16368,24,28,24,4088,4092,1020,24,24,24,0,0,0,0,
7936,16256,16352,496,120,42044,65052,65052,63544,16504,32736,32704,1024,0,0,0,
280,792,792,792,920,1016,1016,1016,924,920,792,792,264,0,0,0,
0,504,1020,1020,768,768,768,768,768,796,1016,504,64,0,0,0,
1544,1800,984,472,248,120,120,248,508,988,1948,1804,8,0,0,0,
24,60,24,24,24,24,24,24,24,24,2040,2040,1280,0,0,0,
1824,4088,4088,2032,896,448,224,4320,4216,14840,16380,4092,0,0,0,0,
1804,1820,920,1016,496,240,224,240,496,944,920,1808,256,0,0,0,
1792,4032,3568,120,56,28,12,12,28,12344,16376,8160,768,0,0,0,
7168,3072,3072,3100,3608,1592,1848,1840,1008,992,992,448,192,0,0,0,
0,504,1020,2044,1804,972,1020,2044,3820,3084,1804,1016,480,0,0,0,
0,3072,7192,7192,7224,7288,3320,3320,3992,3992,3864,3608,24,0,0,0,
0,7264,7264,7264,7280,7920,7920,16368,15344,15352,15320,14808,12312,0,0,0,
0,112,248,248,200,192,192,96,96,224,1016,1016,0,0,0,0,
0,248,248,408,432,384,480,240,56,248,1020,1016,384,0,0,0,
0,1984,4080,3632,1584,1920,2016,4064,3840,3128,2040,2040,0,0,0,0,
0,768,768,384,3520,3824,3696,32764,32764,1784,1536,1536,1536,1024,0,0,
0,1920,1984,2016,112,248,1016,1016,512,920,1016,248,112,0,0,0,
0,224,224,112,112,56,1016,4088,3132,3640,3696,2016,256,0,0,0,
0,2044,2044,888,1816,768,384,448,448,224,96,96,32,0,0,0,
0,2032,15352,7192,3896,4080,992,960,992,1648,1584,1008,64,0,0,0,
0,248,252,924,908,2012,2040,1904,768,896,448,224,64,0,0,0,
0,0,0,0,992,920,792,780,796,796,1016,1016,768,768,768,1792,
0,0,0,0,14744,14812,6552,7096,3064,3952,1840,1584,0,0,0,0,
0,0,0,0,240,984,216,60,28,28,504,248,0,0,0,0,
0,0,0,16,1016,508,16,24,24,56,1016,240,0,0,0,0,
0,0,0,0,920,796,824,312,432,240,96,96,32,48,16,56,
0,0,0,0,1816,796,792,792,792,792,4088,2040,0,0,0,0,
0,16,24,0,24,28,24,24,24,24,120,56,0,0,0,0,
0,0,0,0,480,920,792,780,796,796,440,248,0,0,0,0,
0,0,0,0,984,2044,1848,1560,1560,536,824,248,24,24,24,56,
0,0,0,0,496,472,384,448,432,412,4092,828,0,0,0,0,
0,0,0,0,496,216,28,252,504,448,220,124,0,0,0,0,
1792,768,768,768,992,920,792,780,796,796,4088,2040,0,0,0,0,
448,496,152,24,24,252,24,24,24,24,24,24,24,4,0,0,
0,0,0,0,496,3992,396,412,412,248,448,960,1808,1800,780,508,
56,24,24,24,984,2040,1816,1560,1560,792,792,312,128,0,0,0,
0,16,24,0,24,28,24,24,24,24,24,24,24,24,12,4,
56,28,24,24,472,408,152,120,248,248,984,1948,0,0,0,0,
0,0,0,0,504,252,96,112,48,24,284,510,0,0,0,0,
0,0,0,0,792,956,112,112,96,240,984,460,7,3,0,0,
0,0,0,0,480,408,24,12,28,28,504,248,0,0,0,0,
0,0,0,0,924,796,280,440,176,240,112,32,0,0,0,0,
56,28,24,24,984,2040,1816,1816,792,792,440,248,0,0,0,0,
0,0,0,0,984,1020,1848,792,792,792,3864,1848,0,0,0,0,
0,0,0,0,14808,32764,25400,25368,25368,25368,25368,59192,0,0,0,0,
0,2016,3632,7192,6168,14364,14364,6172,6168,3128,3184,4064,32256,28672,16384,24576,
0,51132,34584,34584,50744,52784,20272,28016,15840,15584,6368,6240,0,0,0,0,
2048,4032,1072,56,28,2044,2044,28,28,56,2104,4064,2048,0,0,0,
384,1916,3632,3632,3632,1584,1008,1968,3632,3120,6192,14588,28672,49152,0,0,
4096,8188,4092,48,56,24,8088,6616,6552,6200,3128,2016,0,0,0,0,
0,7740,7220,7192,7192,7192,7196,7196,7196,7196,7736,8176,3072,3192,1020,0,
0,15996,6196,6168,6168,6172,6172,6172,7196,7224,7736,8176,8192,0,0,0,
0,252,48,48,48,48,48,48,48,48,56,252,0,0,0,0,
0,2016,7216,14360,14364,14364,14364,14364,6172,6200,3128,2016,0,0,0,0,
448,1852,3640,3128,3128,1592,1592,1016,120,56,56,56,120,12,3,1,
0,2040,480,432,944,912,1008,792,792,776,1804,1852,0,0,0,0,
1024,2032,792,536,120,504,1008,900,776,776,792,508,0,0,0,0,
384,4092,7216,14384,14384,14384,14384,14384,6192,6192,3120,2044,0,0,0,0,
1024,2044,1648,1072,48,48,48,2032,1008,560,48,48,240,28,0,0,
4096,8128,3120,2104,24,1564,8156,6620,6620,6200,3192,2016,0,0,0,0,
3072,2044,568,4088,7224,7224,7224,3128,3128,1080,1080,636,1792,1792,0,0,
0,252,48,48,48,48,48,48,48,48,48,48,56,8,6,0,
0,7928,3120,1584,816,432,2032,3888,3632,3120,3120,6396,12288,24576,0,0,
0,252,112,48,48,48,48,48,48,48,1584,2044,1028,0,0,0,
0,4088,2040,768,896,448,448,224,112,112,56,4092,3840,0,0,0,
0,7932,3184,1248,992,448,480,944,920,1816,3864,15932,2,0,0,0,
2048,4032,1584,1048,24,28,28,28,28,2104,1072,2016,1536,0,0,0,
0,15484,6200,6200,3184,3184,1120,1760,736,960,448,384,0,0,0,0,
896,2044,3632,1584,1584,2032,3632,7216,7216,7216,3120,2044,0,0,0,0,
0,4028,7288,14392,14392,14392,14392,14392,6200,6200,6200,15484,0,0,0,0,
0,65504,36400,3608,1564,1564,1564,1564,1564,34328,34360,28640,0,0,0,0,
0,0,96,56,48,48,48,48,48,48,48,120,0,0,0,0,
0,0,480,408,904,384,384,192,64,32,536,1020,0,0,0,0,
0,0,248,456,192,64,496,448,384,384,392,120,0,0,0,0,
0,0,384,448,416,432,400,1928,2044,384,384,448,0,0,0,0,
0,0,1016,248,24,248,504,384,384,384,136,120,0,0,0,0,
0,128,192,48,152,1016,924,780,780,796,408,240,0,0,0,0,
0,0,1016,508,128,192,64,96,96,48,48,56,0,0,0,0,
0,0,496,408,408,248,496,984,780,780,796,248,0,0,0,0,
0,0,496,920,780,796,924,1016,304,384,192,120,16,0,0,0,
0,0,0,2016,2032,1560,1560,1560,1560,1560,2040,2032,1536,1536,1536,0,
0,0,0,24840,13208,13208,14232,14072,7920,7280,7280,7264,0,0,0,0,
0,0,0,480,1008,1560,2040,2040,24,24,2040,2032,0,0,0,0,
16,24,24,252,252,24,24,24,24,24,248,240,0,0,0,0,
0,0,0,1548,1560,792,816,944,496,480,224,192,96,96,48,0,
0,0,0,1560,1560,1560,1560,1560,1560,1560,2032,2032,0,0,0,0,
24,24,0,24,24,24,24,24,24,24,24,24,0,0,0,0,
0,0,0,480,1016,1560,1560,1560,1560,1560,952,496,0,0,0,0,
0,0,0,984,2040,1560,1560,1560,1560,1560,2040,1016,24,24,24,0,
0,0,0,504,1016,768,992,1016,792,792,1016,1016,0,0,0,0,
0,0,0,496,1016,24,56,504,960,768,952,504,0,0,0,0,
1536,1536,1536,2016,2032,1560,1560,1560,1560,1560,2040,2032,0,0,0,0,
240,56,24,252,252,24,24,24,24,24,24,24,0,0,0,0,
0,0,0,2016,2032,1560,1560,1560,1560,1816,2040,1776,1536,944,504,0,
24,24,24,984,1016,1560,1560,1560,1560,1560,1560,1560,0,0,0,0,
48,48,0,56,56,48,48,48,48,48,48,48,48,56,30,0,
24,24,24,1560,792,408,216,248,504,408,792,1560,0,0,0,0,
0,0,0,1016,1016,384,192,96,112,56,1016,1020,0,0,0,0,
0,0,0,1560,824,944,480,224,480,432,824,1820,0,0,0,0,
0,0,0,992,1008,536,24,24,24,24,1016,1008,0,0,0,0,
0,0,0,1548,1560,792,824,816,432,480,224,192,0,0,0,0,
24,24,24,984,2040,1560,1560,1560,1560,1560,2040,1016,0,0,0,0,
0,0,0,984,1016,1560,1560,1560,1560,1560,1560,1560,0,0,0,0,
0,0,0,31704,65528,50712,50712,50712,50712,50712,50712,50712,0,0,0,0,
2016,4080,7216,14360,12312,12312,12312,12312,14360,6200,8176,2016,1536,15872,15360,0,
34328,34328,36632,53016,53040,52528,55728,63920,31200,30944,28896,12512,0,0,0,0,
2040,2040,24,24,24,2040,2040,24,24,24,2040,2040,0,0,0,0,
1016,2040,1560,1560,1560,1816,1016,1016,1816,1560,3096,7192,0,0,0,0,
4092,4092,192,192,192,192,192,192,192,192,192,192,0,0,0,0,
3084,1564,1816,816,1008,480,224,192,192,192,192,192,0,0,0,0,
6168,6168,6168,6168,6168,6168,6168,7192,3096,3128,4080,2016,0,0,0,0,
248,248,48,48,48,48,48,48,48,48,120,248,0,0,0,0,
2016,4080,7216,14360,12312,12312,12312,12312,14360,6200,8176,2016,0,0,0,0,
504,2040,1560,1560,1560,1560,1016,504,24,24,24,24,0,0,0,0,
448,448,992,864,864,1840,1584,2032,4088,3096,7196,6156,0,0,0,0,
2016,4080,3128,24,56,1008,2016,3584,3072,3080,4088,2040,0,0,0,0,
1016,4088,3608,6168,6168,14360,14360,6168,6168,7192,4088,1016,0,0,0,0,
2040,2040,24,24,24,1016,1016,24,24,24,24,24,0,0,0,0,
4032,16368,12336,56,24,24,16152,15896,14360,14392,16368,8128,0,0,0,0,
6168,6168,6168,6168,6168,8184,8184,6168,6168,6168,6168,6168,0,0,0,0,
240,240,192,192,192,192,192,192,192,192,252,124,0,0,0,0,
7192,3608,1816,920,408,248,248,440,920,1816,3608,7192,0,0,0,0,
24,24,24,24,24,24,24,24,24,24,2040,2040,0,0,0,0,
4088,4088,3584,1792,896,384,192,224,112,56,4088,4088,0,0,0,0,
3096,3128,1584,1904,992,448,448,992,864,1584,3640,3096,0,0,0,0,
4032,8176,6192,56,24,24,24,24,24,4152,8176,4064,0,0,0,0,
6156,7196,3096,3096,3640,1584,1584,864,864,992,448,448,0,0,0,0,
1016,2040,3608,3608,1560,2040,4088,3096,7192,3096,4088,2040,0,0,0,0,
6200,6264,6264,6360,6616,6552,7064,6936,7960,7704,7704,7192,0,0,0,0,
14392,14456,15480,15608,13528,14040,14232,13208,13080,12312,12312,12312,0,0,0,0,
128,224,240,192,192,192,192,192,192,192,1008,2032,0,0,0,0,
496,1016,1792,1536,1792,768,896,448,224,112,2040,2040,0,0,0,0,
1008,2040,1536,1536,768,448,1984,1536,1536,1536,2040,1016,0,0,0,0,
768,896,960,864,880,824,792,2044,4092,768,768,768,0,0,0,0,
2032,2032,48,48,48,1008,1808,1536,1536,1536,2040,1016,0,0,0,0,
960,992,48,56,472,1016,1560,1560,3608,1560,2032,992,0,0,0,0,
2040,2040,1536,1792,768,896,384,448,192,224,96,48,0,0,0,0,
1008,2032,1560,1560,1592,1008,1008,1816,1560,1560,1912,1008,0,0,0,0,
480,1016,1560,1560,1560,1560,2040,2032,1536,768,1008,496,0,0,0,0,
0,0,0,1008,1016,792,780,780,780,792,952,1008,768,768,768,0,
0,0,0,12684,6604,6604,7128,2904,3960,3952,3696,1584,0,0,0,0,
0,0,0,496,1016,792,796,1020,28,792,952,496,0,0,0,0,
16,24,24,60,60,24,24,24,24,24,56,120,0,0,0,0,
0,0,0,780,780,408,408,440,240,240,224,96,96,48,56,0,
0,0,0,792,792,792,792,792,792,792,1016,1008,0,0,0,0,
24,24,0,24,24,24,24,24,24,24,24,24,0,0,0,0,
0,0,0,496,1016,792,780,1548,780,792,952,496,0,0,0,0,
0,0,0,504,1016,792,792,536,792,792,952,504,24,24,24,0,
0,0,0,496,1016,792,896,1016,824,780,920,1016,0,0,0,0,
0,0,0,240,504,412,56,504,448,908,440,504,0,0,0,0,
768,768,768,1008,1016,792,780,780,780,792,952,1008,0,0,0,0,
112,56,24,124,60,24,24,24,24,24,24,24,0,0,0,0,
0,0,0,1008,1016,792,796,780,780,792,1016,1008,776,920,504,0,
24,24,24,504,1016,792,792,792,792,792,792,792,0,0,0,0,
24,24,0,24,24,24,24,24,24,24,24,24,24,28,14,0,
24,24,24,920,472,248,120,120,216,472,408,792,0,0,0,0,
0,0,0,1020,1016,448,192,96,48,24,508,1020,0,0,0,0,
0,0,0,796,408,248,240,96,240,504,408,780,0,0,0,0,
0,0,0,240,504,792,8,12,12,792,440,496,0,0,0,0,
0,0,0,780,780,408,408,408,240,240,96,96,0,0,0,0,
24,24,24,504,1016,792,792,792,792,792,952,504,0,0,0,0,
0,0,0,504,1016,792,792,792,792,792,792,792,0,0,0,0,
0,0,0,15864,16376,13208,25368,25368,25368,25368,25368,25368,0,0,0,0,
2016,4080,7224,6168,12312,12316,12312,12312,14360,7992,8176,16352,12288,0,0,0,
34572,34572,34584,52632,52632,52632,55696,30960,30960,30960,12384,12384,0,0,0,0,
4088,4088,24,24,24,2040,2040,24,24,24,4088,4088,0,0,0,0,
2040,4088,7192,7192,3096,4088,1016,1816,3608,3096,7192,6168,0,0,0,0,
4092,2044,192,192,192,192,192,192,192,192,192,192,0,0,0,0,
7180,3096,1592,1840,864,480,448,192,192,192,192,192,0,0,0,0,
7192,7192,7192,7192,7192,7192,7192,3096,3096,3128,4080,2016,0,0,0,0,
24,24,24,24,24,24,24,24,24,24,24,24,0,0,0,0,
2016,4080,6200,6168,12312,12312,12312,12312,6168,6200,4080,2016,0,0,0,0,
2040,4088,3096,3096,3096,4088,2040,24,24,24,24,24,0,0,0,0,
192,448,480,864,880,816,1584,2040,4088,3096,3084,6156,0,0,0,0,
1008,2040,3608,1048,120,1008,1984,3584,3096,3096,2040,1008,0,0,0,0,
1016,4088,3096,7192,6168,6168,6168,6168,7192,3096,4088,1016,0,0,0,0,
2040,2040,24,24,24,1016,1016,24,24,24,24,24,0,0,0,0,
4064,8176,6200,4120,24,24,16152,15896,12312,14392,8176,4064,0,0,0,0,
7192,7192,7192,7192,7192,8184,8184,7192,7192,7192,7192,7192,0,0,0,0,
384,384,384,384,384,384,384,384,396,396,504,248,0,0,0,0,
3096,1560,792,408,216,248,504,920,1816,1560,3608,7192,0,0,0,0,
24,24,24,24,24,24,24,24,24,24,1016,2040,0,0,0,0,
2040,2040,1792,896,384,192,224,112,48,24,2044,4092,0,0,0,0,
3096,3640,1840,864,480,448,448,992,1904,1592,3608,7196,0,0,0,0,
2016,4080,7224,6168,24,24,24,24,6168,7224,4080,2016,0,0,0,0,
6156,3100,3096,3608,1592,1584,816,864,864,480,448,448,0,0,0,0,
1016,2040,1560,1560,1560,1016,2040,3096,3096,3096,2040,2040,0,0,0,0,
6168,6200,6264,6264,6360,6616,6552,6936,7960,7704,7704,7192,0,0,0,0,
12344,14392,14456,14456,15480,15576,13528,14040,13976,13208,13208,13080,0,0,0,0,
192,224,240,248,192,192,192,192,192,192,192,192,0,0,0,0,
496,1016,792,776,768,896,448,224,112,56,1016,1020,0,0,0,0,
240,504,792,768,384,480,960,768,776,792,952,496,0,0,0,0,
384,448,480,480,432,408,408,1020,1020,384,384,384,0,0,0,0,
1008,1008,24,24,504,1016,792,768,776,792,952,496,0,0,0,0,
496,1016,792,24,488,1020,796,796,792,792,952,496,0,0,0,0,
1016,1016,896,384,192,192,224,96,96,48,48,48,0,0,0,0,
496,1016,792,792,1016,496,1016,792,780,792,952,496,0,0,0,0,
240,504,792,796,796,792,1016,1008,768,792,440,496,0,0,0,0,
0,0,0,0,496,408,396,396,396,396,408,504,384,384,384,960,
0,0,0,0,6620,6552,2456,2992,4080,1904,1632,544,0,0,0,0,
0,0,0,0,112,200,508,12,12,268,248,248,0,0,0,0,
0,0,16,24,60,24,24,24,24,24,24,56,0,0,0,0,
0,0,0,0,924,280,408,176,176,224,96,96,96,32,60,8,
0,0,0,0,476,408,408,408,408,408,472,1016,0,0,0,0,
0,24,0,0,24,24,24,24,24,24,24,60,0,0,0,0,
0,0,0,0,240,408,908,780,780,796,408,240,0,0,0,0,
0,0,0,0,508,504,408,792,792,280,408,248,24,24,24,60,
0,0,0,0,120,216,200,240,216,204,220,504,0,0,0,0,
0,0,0,0,120,72,24,56,112,192,200,120,0,0,0,0,
0,448,384,384,496,408,396,396,396,396,408,1016,0,0,0,0,
0,240,144,16,124,24,24,24,24,24,24,60,0,0,0,0,
0,0,0,0,496,472,408,408,248,48,24,504,776,268,504,48,
0,28,24,24,248,440,408,408,408,408,408,1020,0,0,0,0,
0,48,16,0,56,56,48,48,48,48,48,48,16,16,30,4,
0,28,24,24,984,216,120,56,120,216,472,956,0,0,0,0,
0,0,0,0,504,200,224,96,48,56,280,508,0,0,0,0,
0,0,0,0,508,248,112,96,96,208,472,988,0,0,0,0,
0,0,0,0,240,472,140,12,12,284,248,120,0,0,0,0,
0,0,0,0,924,280,432,176,176,224,96,96,0,0,0,0,
0,28,24,24,248,504,920,792,792,280,408,248,0,0,0,0,
0,0,0,0,252,440,408,408,408,408,408,1020,0,0,0,0,
0,0,0,0,7416,7096,4504,12696,12696,12696,12696,15292,0,0,0,0,
0,2016,3120,7192,6172,6172,6172,6172,6168,3096,3632,2016,960,1920,7680,0,
0,51132,50968,50736,17968,28528,11616,15840,14816,6336,6336,4288,0,0,0,0,
0,2044,1048,24,536,1016,1016,536,24,2072,1080,2044,0,0,0,0,
0,1020,1816,1560,1816,952,504,472,920,792,1592,3708,0,0,0,0,
0,4092,3268,2244,192,192,192,192,192,192,192,496,0,0,0,0,
0,7292,3120,1136,736,960,448,384,384,384,384,992,0,0,0,0,
0,7292,2104,2104,2104,2104,2104,2104,2096,2096,1072,992,0,0,0,0,
0,124,56,48,48,48,48,48,48,48,56,124,0,0,0,0,
0,2016,3120,7192,6172,6172,6172,6172,6168,3096,3632,2016,0,0,0,0,
0,508,1848,1560,1816,792,504,56,24,24,56,124,0,0,0,0,
0,128,384,448,832,864,1824,2032,2032,3088,3096,7708,0,0,0,0,
0,496,792,536,56,240,480,960,896,776,792,504,0,0,0,0,
0,1020,3640,7224,6200,6200,6200,6200,6200,3128,3896,1020,0,0,0,0,
0,2044,1048,24,536,1016,1016,536,24,24,56,124,0,0,0,0,
0,4064,3120,2072,28,28,7708,3100,3100,3096,3120,4064,0,0,0,0,
0,7804,3128,3128,3128,3128,4088,3128,3128,3128,3128,7804,0,0,0,0,
0,248,112,96,96,96,96,96,96,96,60,60,0,0,0,0,
0,8060,1592,824,184,248,248,504,952,1848,3640,8060,0,0,0,0,
0,124,56,24,24,24,24,24,24,2072,1080,2044,0,0,0,0,
0,2044,1804,772,384,448,224,96,112,2104,3096,4092,0,0,0,0,
0,7804,1136,1632,992,448,448,960,1888,1584,3608,7740,0,0,0,0,
0,4064,3120,2072,28,28,28,28,28,24,3120,2016,0,0,0,0,
0,7228,2104,3120,1136,1120,1760,704,960,448,384,384,0,0,0,0,
0,1020,1848,1584,1584,1008,1008,1584,3632,3632,1592,1020,0,0,0,0,
0,7228,2104,2168,2296,2520,2968,2840,3864,3608,3096,2108,0,0,0,0,
0,61500,28728,30840,30840,27896,25816,26072,25496,29592,29464,63804,0,0,0,0,
0,96,112,96,96,96,96,96,96,96,96,240,0,0,0,0,
0,240,472,388,384,384,192,64,32,528,1016,508,0,0,0,0,
0,240,200,128,192,224,480,384,384,384,136,120,0,0,0,0,
0,192,192,224,240,208,200,204,1020,192,192,192,0,0,0,0,
0,496,240,56,248,224,448,384,384,384,136,124,0,0,0,0,
0,192,48,56,216,504,412,780,780,792,408,240,0,0,0,0,
0,504,412,384,128,128,192,192,64,96,96,32,0,0,0,0,
0,240,408,408,184,112,240,472,408,392,408,240,0,0,0,0,
0,240,408,396,780,796,408,496,384,192,96,56,0,0,0,0,
]


}